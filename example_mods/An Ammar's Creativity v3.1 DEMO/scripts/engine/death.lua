daSongName="";SpriteUtil=nil;Timer=nil;thisBPM=100;targetBGAlpha=1;mobileMode=false;canClick=false;function onCreate()addHaxeLibrary("GameOverSubstate");addHaxeLibrary("WeekData");addHaxeLibrary("MusicBeatState");daSongName=string.lower(songName:gsub("%s+",""));package.path=getProperty("modulePath")   .. ";"   .. package.path ;SpriteUtil=require("SpriteUtil");Timer=require("Timer");mobileMode=buildTarget=="android" ;Timer.startTimer(0.5,function(v21,v22)canClick=true;end);customGameOver(true);end function onGameOverStart()runHaxeCode([[  
    camDead = new FlxCamera();
    camDead.bgColor = 0x00;
    FlxG.cameras.add(camDead,false);
    game.variables.set("camDead", camDead);

    FlxTween.tween(game.camHUD, {alpha:0}, 1);
    game.persistentDraw = true;
]]);SpriteUtil.makeSprite({tag="gameOverBG",graphicWidth=1400,graphicHeight=900,graphicColor="000000"});screenCenter("gameOverBG");setProperty("gameOverBG.alpha",0.5);setBlendMode("gameOverBG","multiply");runHaxeCode("game.getLuaObject('gameOverBG').camera = camDead");customGameOver(false);SpriteUtil.makeSprite({tag="gameOverFlash",graphicWidth=1400,graphicHeight=900,graphicColor="FFFFFF"});screenCenter("gameOverFlash");setProperty("gameOverFlash.alpha",1);runHaxeCode("game.getLuaObject('gameOverFlash').camera = camDead");doTweenAlpha("gameOverFlash","gameOverFlash",0,2);doTweenAlpha("gameOverBG","gameOverBG",targetBGAlpha,1);end local v0={};function customGameOver(v6)if (daSongName=="no-debug") then if v6 then setPropertyFromClass("GameOverSubstate","deathSoundName","gameover/vineboom");precacheSound("gameover/vineboom");precacheImage("ammarvoid/eyes");precacheImage("ammarvoid/mouth");else SpriteUtil.makeAnimateSprite({tag="ammarEyes",antialiasing=false});runHaxeCode("game.getLuaObject('ammarEyes').camera = camDead");loadGraphic("ammarEyes","ammarvoid/eyes",75);addAnimation("ammarEyes","idle",{0,1},3,true);addAnimation("ammarEyes","blink",{2},0,true);playAnim("ammarEyes","idle");setProperty("ammarEyes.antialiasing",false);setProperty("ammarEyes.alpha",0);doTweenAlpha("ammarEyes","ammarEyes",1,2);scaleObject("ammarEyes",3,3);screenCenter("ammarEyes");SpriteUtil.makeSprite({tag="ammarMouth",image="ammarvoid/mouth"});setProperty("ammarMouth.alpha",0);runHaxeCode("game.getLuaObject('ammarMouth').camera = camDead");doTweenAlpha("ammarMouth","ammarMouth",1,2);scaleObject("ammarMouth",3,3);setProperty("ammarMouth.antialiasing",false);v0.eyeX=getProperty("ammarEyes.x");v0.eyeY=getProperty("ammarEyes.y") -50 ;SpriteUtil.makeText({tag="deadText",text="",align="center",borderColor="0x00000000",size=60,borderSize=0,borderQuality=0,color="FFFFFFF",x=0,y=0,width= -1,font="1_Minecraft-Regular.otf"});Timer.startTimer(0.4,function(v25,v26)typeText("deadText","Try Again?",1);end);runHaxeCode("game.getLuaObject('deadText').camera = camDead");screenCenter("deadText");setProperty("deadText.y",500);end end if (daSongName=="google") then if v6 then else SpriteUtil.makeText({tag="deadText",text="",align="center",borderColor="0x00000000",size=60,borderSize=0,borderQuality=0,color="FFFFFFF",x=0,y=0,width= -1,font="Google/Product Sans Regular.ttf"});Timer.startTimer(0.4,function(v27,v28)typeText("deadText","Don't Give Up!\nTry Again?",1);end);runHaxeCode("game.getLuaObject('deadText').camera = camDead");screenCenter("deadText");targetBGAlpha=0.75;end end if ((getPropertyFromClass("PlayState","curStage")=="discordStage") or (getPropertyFromClass("PlayState","curStage")=="demonbg")) then if v6 then setPropertyFromClass("GameOverSubstate","deathSoundName","gameover/discordVoiceLeft");else SpriteUtil.makeSprite({tag="deathBG",graphicColor="36393F",graphicWidth=1300,graphicHeight=800});runHaxeCode("game.getLuaObject('deathBG').camera = camDead;");screenCenter("deathBG");SpriteUtil.makeSprite({tag="deathMee",image="discord/mee6"});runHaxeCode("game.getLuaObject('deathMee').camera = camDead;");screenCenter("deathMee");scaleObject("deathMee",1.45,1.45);setProperty("deathMee.alpha",0);SpriteUtil.makeText({tag="deadText",text="",align="center",borderColor="0x00000000",size=60,borderSize=0,borderQuality=0,color="FFFFFFF",x=0,y=0,width= -1,font="Discord/ggsans-Medium.ttf"});Timer.startTimer(0.5,function(v29,v30)typeText("deadText","Annoying User just left the server",1.5);doTweenAlpha("deathMee","deathMee",1,1.5);end);runHaxeCode("game.getLuaObject('deadText').camera = camDead");SpriteUtil.makeSprite({tag="deathVig",image="vignette"});runHaxeCode("game.getLuaObject('deathVig').camera = camDead;");screenCenter("deathVig");end end if ((getPropertyFromClass("PlayState","curStage")=="youtubeStage") or (getPropertyFromClass("PlayState","curStage")=="twitterStage")) then if v6 then setPropertyFromClass("GameOverSubstate","deathSoundName","gameover/shutdown");else SpriteUtil.makeSprite({tag="deathBG",graphicColor="000000",graphicWidth=1300,graphicHeight=800});runHaxeCode("game.getLuaObject('deathBG').camera = camDead;");screenCenter("deathBG");SpriteUtil.makeSprite({tag="deathPCBG",graphicColor="FFFFFF",graphicWidth=1280 * 0.9 ,graphicHeight=720 * 0.85 });runHaxeCode("game.getLuaObject('deathPCBG').camera = camDead;");screenCenter("deathPCBG");setProperty("deathPCBG.color",getColorFromHex("0063BB"));SpriteUtil.makeText({tag="deadText",text="Shutting Down",align="center",borderColor="0x00000000",size=20,borderSize=0,borderQuality=0,color="FFFFFFF",x=0,y=0,width= -1,font="SegoeUIVF.ttf"});runHaxeCode("game.getLuaObject('deadText').camera = camDead");screenCenter("deadText");SpriteUtil.makeSprite({tag="deathPC",image="computer"});runHaxeCode("game.getLuaObject('deathPC').camera = camDead;");screenCenter("deathPC");SpriteUtil.makeSprite({tag="deathVig",image="vignette"});runHaxeCode("game.getLuaObject('deathVig').camera = camDead;");screenCenter("deathVig");setProperty("camDead.zoom",1.3);Timer.startTimer(2,function(v31,v32)runHaxeCode("FlxTween.tween(camDead, {zoom : 1}, 2, {ease : FlxEase.quadOut})");end);end end end function customUpdateGameOver()if (daSongName=="no-debug") then setProperty("ammarEyes.x",v0.eyeX + (math.sin(os.clock()) * 10) );setProperty("ammarEyes.y",v0.eyeY + (math.cos(os.clock()) * 10) );setProperty("ammarMouth.x",(v0.eyeX + (math.sin(os.clock() + 0.2 ) * 9)) -2 );setProperty("ammarMouth.y",v0.eyeY + (math.cos(os.clock() + 0.2 ) * 9) );end if ((getPropertyFromClass("PlayState","curStage")=="discordStage") or (getPropertyFromClass("PlayState","curStage")=="demonbg")) then screenCenter("deadText");setProperty("deadText.x",getProperty("deadText.x") + 55 );setProperty("deathMee.x",(getProperty("deadText.x")/getProperty("deadText.scale.x")) -160 );setProperty("deathMee.y",(getProperty("deadText.y")) -40 );end if ((getPropertyFromClass("PlayState","curStage")=="youtubeStage") or (getPropertyFromClass("PlayState","curStage")=="twitterStage")) then screenCenter("deadText");setProperty("deadText.offset.y",math.sin(os.clock()) * 10 );end end function onGameOverConfirm(v7)if v7 then runHaxeCode([[
    camDead.flash(0x20FFFFFF, 2, null, true);
    camDead.fade(0xFF000000, 2.7);
    ]]);if (daSongName=="google") then cancelTimer("deadTypeText");setTextString("deadText","Hurray!");end if (daSongName=="no-debug") then playAnim("ammarEyes","blink",true);end if ((getPropertyFromClass("PlayState","curStage")=="discordStage") or (getPropertyFromClass("PlayState","curStage")=="demonbg")) then cancelTimer("deadTypeText");setTextString("deadText","Annoying User joined the server");end if ((getPropertyFromClass("PlayState","curStage")=="youtubeStage") or (getPropertyFromClass("PlayState","curStage")=="twitterStage")) then setTextString("deadText","Please wait");end else runHaxeCode([[  
        game.persistentDraw = false;
    ]]);loadSong("ammar menu", -1);end end function onUpdate(v8)if inGameOver then if (mobileMode and canClick) then if mouseClicked("") then runHaxeCode([[
                camDead.flash(0x20FFFFFF, 0.5, null, true);
                GameOverSubstate.instance.endBullshit();
            ]]);elseif getPropertyFromClass("flixel.FlxG","android.justReleased.BACK") then runHaxeCode([[
                FlxG.sound.music.stop();
                PlayState.deathCounter = 0;
                PlayState.seenCutscene = false;
                PlayState.chartingMode = false;

                WeekData.loadTheFirstEnabledMod();
                if (PlayState.isStoryMode)
                    MusicBeatState.switchState(new StoryMenuState());
                else
                    MusicBeatState.switchState(new FreeplayState());

                FlxG.sound.playMusic(Paths.music('freakyMenu'));
                game.callOnLuas('onGameOverConfirm', [false]);
            ]]);end end calculateBeat();customUpdateGameOver();end end local v1=0;local v2=0;function calculateBeat()local v9=getPropertyFromClass("flixel.FlxG","sound.music.time")/1000 ;local v10=60/thisBPM ;v2=math.ceil(v9/(v10/4) ) -1 ;if (v2~=v1) then v1=v2;customStepHit();end end function customStepHit()if (((v2%4)==0) and ((daSongName=="google") or (daSongName=="no-debug"))) then scaleObject("deadText",1.1,1.1);doTweenX("deadTextScaleX","deadText.scale",1,1,"quadOut");doTweenY("deadTextScaley","deadText.scale",1,1,"quadOut");end if (((v2%16)==0) and (daSongName=="no-debug")) then playAnim("ammarEyes","blink",true);runTimer("unblink",0.1);end if (((v2%8)==0) and ((getPropertyFromClass("PlayState","curStage")=="discordStage") or (getPropertyFromClass("PlayState","curStage")=="demonbg"))) then setProperty("deathVig.alpha",0.8);doTweenAlpha("deathVIG","deathVig",1,0.6);scaleObject("deadText",(((v2%16)==0) and 1.05) or 0.95 ,(((v2%16)==8) and 1.05) or 0.95 ,false);doTweenX("deadTextScaleX","deadText.scale",1,1,"quadOut");doTweenY("deadTextScaley","deadText.scale",1,1,"quadOut");end if (((v2%8)==0) and ((getPropertyFromClass("PlayState","curStage")=="youtubeStage") or (getPropertyFromClass("PlayState","curStage")=="twitterStage"))) then setProperty("deathVig.alpha",0.8);doTweenAlpha("deathVIG","deathVig",1,0.6);scaleObject("deadText",(((v2%16)==0) and 1.05) or 0.95 ,(((v2%16)==8) and 1.05) or 0.95 ,false);doTweenX("deadTextScaleX","deadText.scale",1,1,"quadOut");doTweenY("deadTextScaley","deadText.scale",1,1,"quadOut");end end function onUpdatePost(v11)if inGameOver then if (daSongName=="no-debug") then screenCenter("deadText","X");end end end local v3="";local v4="";function typeText(v12,v13,v14)cancelTimer("deadTypeText");setTextString(v12,"");v3=v13;v4=v12;runTimer("deadTypeText",v14/ #v3 , #v3);end function onTimerCompleted(v15,v16,v17)if (Timer~=nil) then Timer.timerEnd(v15,v16,v17);end if (v15=="deadTypeText") then setProperty(v4   .. ".text" ,string.sub(v3,1,v16-v17 ));end if (v15=="unblink") then playAnim("ammarEyes","idle",true);end end function lerp(v18,v19,v20)return v18 + ((v19-v18) * v20) ;end